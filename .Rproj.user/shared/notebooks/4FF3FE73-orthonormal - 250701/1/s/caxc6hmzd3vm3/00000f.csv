"0","generate_orthonormal_matrix <- function(n, p) {"
"0","  if (p >= n) stop(""p must be less than n"")"
"0","  "
"0","  mat <- matrix(rnorm(n * (p + 1)), nrow = n)"
"0","  "
"0","  mat_centered <- scale(mat, center = TRUE, scale = FALSE)"
"0","  "
"0","  qr_result <- qr(mat_centered)"
"0","  Q <- qr.Q(qr_result)"
"0","  "
"0","  X <- Q[, 1:p]"
"0","  "
"0","  col_norms <- apply(X, 2, function(col) sqrt(sum(col^2)))"
"0","  X_scaled <- sweep(X, 2, col_norms, ""/"") * n"
"0","  "
"0","  return(X_scaled)"
"0","}"
